現在、シェーディングから形状を求める手法の多くは、反射率マップを完全に把握していることを前提としている。ここでは、ランバート面を未知の方向から点光源で照らす状況を考えた。
このように、固定された反射率マップではなく、パラメータ化された反射率マップを扱うことができる。
SFSを補正する局所的アプローチは、未知の光源方向を扱うことを意図しているが、表面は局所的に球面であるという制限的な仮定を除いて、いくつかの欠点があることがわかった。
表面の向きを記述するために単位法線ベクトルを採用したことは、本手法の開発において重要なポイントであった。これにより、簡単な導出とエレガントな表現が可能になった。
問題は、明るさの誤差項、正則化項、および法線が単位長であるという条件を強制するラグランジュ乗数を含む正定関数を最小化するものとして定式化された。
この変動微積分問題に対するオイラー方程式は、未知の表面法線関数における2階偏微分方程式であることが示された。収束的な反復スキームにより、離散領域でこの問題を解くことができた。
光源の方向は、表面の形状がわかっていれば閉じた形で決定できる。任意の反復処理中に、表面形状の現在の推定値を使用して光源方向の推定値を得ることができる。表面形状の推定精度を上げるための反復は、光源方向の推定と並行して行うことができる。
この方法を実装し、形状や音源の方向を復元するテストを行った。また、解に現れる可能性のある双方向のあいまいさについても議論した。さらに、反復スキームのシェーディングから形状を復元するコンポーネントを、より一般的な反射率マップに拡張する方法を示した。